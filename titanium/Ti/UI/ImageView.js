define(["Ti/_/declare","Ti/_/event","Ti/_/lang","Ti/_/style","Ti/_/UI/Widget","Ti/UI","Ti/Filesystem"],function(e,t,i,r,o,n,a){var s=r.set,l=require.is,u=require.on,d=e(o,{domType:"img",onload:null,onerror:null,constructor:function(){this.domNode.ondragstart=function(){return!1}},_getContentSize:function(){return{width:this.domNode.width,height:this.domNode.height}},_preLayout:function(e,t,i,r){this.domNode.style.width="",this.domNode.style.height="";var o=this.domNode.width/this.domNode.height,a=this.__values__.properties,s=a.width,l=a.height;return i||r?i?r?(a.width=n.SIZE,a.height=n.SIZE):(a.width=t*o,a.height=t):(a.width=e,a.height=e/o):e/t>o?(a.width=t*o,a.height=t):(a.width=e,a.height=e/o),s!==a.width||l!==a.height},_imageRatio:1,properties:{src:{set:function(e){var r,o=this.domNode,n="none",a=i.hitch(this,function(e){t.off(r),this._triggerLayout(),this.onerror&&this.onerror(e)});return e&&(e=e.replace(/^(\/|\.\/)/,""),n="inherit",r=[u(o,"load",this,function(){o.style.width="",o.style.height="";var e=o.width/o.height;isNaN(e)&&(e=0===o.width?1:1/0),this._imageRatio=e,this._triggerLayout(),this.onload&&this.onload()}),u(o,"error",a),u(o,"abort",a)],o.src=require.cache(e)||e),s(o,"display",n),e}}}});return e("Ti.UI.ImageView",o,{_createImage:function(e,t,i){var r=l(e,"String")&&e.match(/^(.+)\:\/\//);switch(r&&~a.protocols.indexOf(r[1])&&(e=a.getFile(e)),e&&e.declaredClass){case"Ti.Filesystem.File":e=e.read();case"Ti.Blob":e=e.toString()}return new d({onload:t,onerror:i,src:e})},_defaultWidth:n.SIZE,_defaultHeight:n.SIZE,_slideshowCount:0,_setSlideshowInterval:function(){var e=this,t=e._images;clearInterval(this._slideshowTimer),this._slideshowTimer=setInterval(function(){var i=!1;return s(t[e._currentIndex].domNode,"display","none"),e.reverse?0===--e._currentIndex&&(e._currentIndex=e.images.length-1,i=!0):++e._currentIndex===e.images.length&&(e._currentIndex=0,i=!0),s(t[e._currentIndex].domNode,"display","inherit"),e.repeatCount&&i&&++e._slideshowCount===e.repeatCount?void e.stop():void e.fireEvent("change",{index:e._currentIndex})},this.duration)},start:function(){this._images&&(this._setState(0,1),this._slideshowCount=0,this._setSlideshowInterval(),this.fireEvent("start"))},stop:function(){var e=this._images;if(e){if(clearInterval(this._slideshowTimer),e.length){var t=0;this.reverse&&(t=e.length-1),this._currentIndex&&s(e[this._currentIndex].domNode,"display","none"),s(e[t].domNode,"display","inherit"),this._currentIndex=t}this._setState(0,0),this.fireEvent("stop")}},pause:function(){this._images&&(clearInterval(this._slideshowTimer),this._setState(1,0),this.fireEvent("pause"))},resume:function(){this._images&&(this._setSlideshowInterval(),this._setState(0,1))},_setState:function(e,t){var i=this.__values__.constants;i.paused=!!e,i.animating=!!t},constants:{animating:!1,paused:!1},properties:{duration:{set:function(e){return Math.max(30,e)},value:200},image:{set:function(e){this._removeAllChildren(),this._images=void 0;var t=this;return this._add(this._createImage(e,function(){t.fireEvent("load",{state:"image"})},function(e){this.fireEvent("error",e)})),e}},images:{set:function(e){var t=void 0,i=0,r=0;return this._removeAllChildren(),l(e,"Array")&&(t=[],e.forEach(function(o){var n=this._createImage(o,function(){!r&&++i===e.length&&this.fireEvent("load",{state:"image"})},function(e){r||(r=1)&&this.fireEvent("error",e)});s(n.domNode,"display","none"),t.push(n),this._add(n)},this)),this._images=t,e},post:function(){this.stop()}},repeatCount:0,reverse:!1}})});