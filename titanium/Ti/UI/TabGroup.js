define(["Ti/_/declare","Ti/_/UI/SuperView","Ti/UI/View","Ti/UI","Ti/_/lang"],function(e,t,i,r,o){var n=require.is,a=r.FILL,s={post:"_updateTabsBackground"};return e("Ti.UI.TabGroup",t,{constructor:function(t){var n=this,s=(n.__values__.constants.tabsAtBottom=o.val(t&&t.tabsAtBottom,n.__values__.constants.tabsAtBottom),e(i,{declaredClass:"Ti.UI.TabBarContainer"}));n._tabBarContainer=new s({width:a,layout:r._LAYOUT_CONSTRAINING_HORIZONTAL}),n.tabHeight=75,n._tabContentContainer=r.createView({width:a,height:a}),n.layout=r._LAYOUT_CONSTRAINING_VERTICAL,n.tabs=[],n.tabsAtBottom=o.val(t&&t.tabsAtBottom,!0)},addTab:function(e){var t=this.tabs;t.push(e),e._setTabGroup(this),1===t.length?this.activeTab=e:this._tabBarContainer._add(this._createTabDivider()),this._tabBarContainer._add(e),this._updateTabBackground(e),this._publish(e)},_addTabContents:function(e){this._tabContentContainer._add(e)},_removeTabContents:function(e){this._tabContentContainer._remove(e)},removeTab:function(e){var t=this.tabs,i=this.tabs.indexOf(e);i>=0&&(t.splice(i,1),this._tabBarContainer.remove(e),e===this._activeTab&&this._activateTab(t[0]),this._unpublish(e))},_createTabDivider:function(){return r.createView({width:this.tabDividerWidth,height:a,backgroundColor:this.tabDividerColor})},close:function(){this._previousTab=null,t.prototype.close.call(this)},_getEventData:function(){var e=this.tabs,t=this._previousTab,i=this._activeTab;return{index:i&&e.indexOf(i),previousIndex:t&&e.indexOf(t),tab:i,previousTab:t}},_handleFocusEvent:function(){var e=this._previousTab,t=this._activeTab;e&&e._blur(),!this._focused&&this._opened&&(this.fireEvent("focus",this._getEventData()),t&&t._focus()),this._focused=1},_handleBlurEvent:function(e){if(e){for(var t,i=0,r=this.tabs.length;r>i;)t=this.tabs[i++],(2!==e||t===this._activeTab)&&t._blur();this._previousTab=void 0}this._focused&&this._opened&&this.fireEvent("blur",this._getEventData()),this._focused=0},_activateTab:function(e){var t=(this.tabs,this._activeTab);t!==e&&((this._previousTab=t)&&(t.active=!1,t._doBackground()),r.currentTab=this._activeTab=e,e.active=!0,this._updateTabsBackground())},_updateTabBackground:function(e){var t=e.active?"activeTab":"tabs";["","Focused","Disabled","Selected"].forEach(function(i){i="Background"+i,e["_default"+i+"Color"]=this[t+i+"Color"],e["_default"+i+"Image"]=this[t+i+"Image"]},this),e._doBackground()},_updateTabsBackground:function(){for(var e=this.tabs,t=0,i=e.length;i>t;)this._updateTabBackground(e[t++])},_updateDividers:function(){for(var e=this._tabBarContainer._children,t=1;t<e.length;t+=2){var i=e[t];i.width=this.tabDividerWidth,i.backgroundColor=this.tabDividerColor}},_defaultWidth:a,_defaultHeight:a,constants:{bubbleParent:!1},properties:{activeTab:{set:function(e){return n(e,"Number")&&(e=this.tabs[e]),!e in this.tabs?void 0:e},post:function(e){o.isDef(e)&&this._activateTab(e)}},tabs:{set:function(e){if(n(e,"Array")){var t,i=this._tabBarContainer;if(i._removeAllChildren(),e.length)for(t=0;t<e.length;t++)e[t]._setTabGroup(this),0==t&&this._activateTab(this.activeTab=e[t]),this._publish(e[t]),t&&i._add(this._createTabDivider()),i._add(e[t]);return e}},post:"_updateTabsBackground"},tabsAtBottom:{set:function(e,t){if(e!==t){var i=this._tabContentContainer,r=this._tabBarContainer;this._activeTab&&this._activeTab._setNavBarAtTop(e),this._remove(i),this._remove(r),e?(this._add(i),this._add(r)):(this._add(r),this._add(i))}return e}},activeTabBackgroundColor:{post:"_updateTabsBackground",value:"#fff"},activeTabBackgroundImage:s,activeTabBackgroundDisabledColor:{post:"_updateTabsBackground",value:"#888"},activeTabBackgroundDisabledImage:s,activeTabBackgroundFocusedColor:{post:"_updateTabsBackground",value:"#ccc"},activeTabBackgroundFocusedImage:s,activeTabBackgroundSelectedColor:{post:"_updateTabsBackground",value:"#ddd"},activeTabBackgroundSelectedImage:s,tabsBackgroundColor:{post:"_updateTabsBackground",value:"#aaa"},tabsBackgroundImage:s,tabsBackgroundDisabledColor:{post:"_updateTabsBackground",value:"#666"},tabsBackgroundDisabledImage:s,tabsBackgroundFocusedColor:{post:"_updateTabsBackground",value:"#ccc"},tabsBackgroundFocusedImage:s,tabsBackgroundSelectedColor:{post:"_updateTabsBackground",value:"#ddd"},tabsBackgroundSelectedImage:s,tabDividerColor:{post:"_updateDividers",value:"#555"},tabDividerWidth:{post:"_updateDividers",value:1},tabHeight:{set:function(e){return this._tabBarContainer.height=e,e}}}})});