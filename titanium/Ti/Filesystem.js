define(["Ti/_","Ti/_/Evented","Ti/_/lang","Ti/Filesystem/File"],function(e,t,i,r){function o(){var e,t=/(.+:\/\/)?(.*)/,r="",o=[],n=i.toArray(arguments).filter(function(e){return void 0!==e}).map(function(e){return r||(r=e.match(t))&&(r=r[1]||""),e.replace(r,"").replace(/^\/|\/$/g,"")}).join("/");return n.split("/").forEach(function(t){if(".."===t&&".."!==e){if(!o.length)throw new Error('Irrational path "'+n+'"');o.pop(),e=o[o.length-1]}else t&&"."!==t&&o.push(e=t)}),n=r+o.join("/"),r||/^\//.test(n)||(n="/"+n),n}function n(t){var i=new r({_type:t.charAt(0),nativePath:s+e.uuid()});return i["create"+t]()?i:null}var a="appdata://",s="tmp://";return i.setObject("Ti.Filesystem",t,{constants:{MODE_APPEND:4,MODE_READ:1,MODE_WRITE:2,applicationDataDirectory:a,lineEnding:"\n",resourcesDirectory:"/",separator:"/",tempDirectory:s},protocols:["appdata","tmp"],createTempDirectory:function(){return n("Directory")},createTempFile:function(){return n("File")},getFile:function(){return new r(o.apply(null,arguments))},isExternalStoragePresent:function(){return!1},openStream:function(e){var t,n=i.toArray(arguments);return n.shift(),t=new r(o.apply(null,n)),t.open(e)}})});