define(["Ti/_/css","Ti/_/declare","Ti/UI/View","Ti/UI","Ti/_/lang"],function(e,a,t,i,n){var s=n.isDef,o=i.FILL,r="TiUINavigationGroup";return a("Ti.UI.MobileWeb.NavigationGroup",t,{constructor:function(a){var t=this,n=t.constants.window=a&&a.window,s=t._navBarContainer=i.createView({height:50,width:i.FILL,layout:i._LAYOUT_CONSTRAINING_HORIZONTAL});e.add(s.domNode,r),t.layout=i._LAYOUT_CONSTRAINING_VERTICAL,s.add(t._leftContainer=i.createView({width:i.SIZE,height:"100%",left:5,right:5})),s.add(t._centerContainer=i.createView({width:i.FILL,height:"100%"})),s.add(t._rightContainer=i.createView({width:i.SIZE,height:"100%",left:5,right:5})),t._add(s),t._add(t._contentContainer=i.createView({width:o,height:o})),this.navBarAtTop=!0,s._getBorderFromCSS(),t._windows=[],n&&t.open(n)},_defaultWidth:o,_defaultHeight:o,_updateNavBar:function(){var e,a,t,n=this,s=n._windows,o=s.length,r=s[o-1],_=this._navBarContainer,l=n._leftContainer,d=n._centerContainer,c=n._rightContainer;r&&(t=r.rightNavButton,r.leftNavButton?e=r.leftNavButton:(n._backButton||(n._backButton=i.createButton({title:"Back"}),require.on(n._backButton,"singletap",function(){n.close(s[s.length-1])})),o>1&&(e=n._backButton)),l._children[0]!==e&&(l._removeAllChildren(),e&&l._add(e)),c._children[0]!==t&&(c._removeAllChildren(),t&&c._add(t)),_.backgroundColor=r.barColor,_.backgroundImage=r.barImage,_.opacity=r.translucent?.5:1,_.height=r.navBarHidden&&r.modal?0:50,a=r.titleControl?r.titleControl:r.titleImage?r._titleImageView||(r._titleImageView=i.createImageView({image:r.titleImage})):r._titleControl||(r._titleControl=i.createLabel({text:r._getTitle()||this._tab&&this._tab._getTitle()||"",width:"100%",height:"100%",textAlign:i.TEXT_ALIGNMENT_CENTER})),d._children[0]!==a&&(d._removeAllChildren(),a&&d._add(a)))},_getTopWindow:function(){var e=this._windows,a=e.length;return a?e[e.length-1]:null},open:function(e){if(!e._opened){var a=this._windows,t=this._tab;e._navGroup=this,!s(e.backgroundColor)&&!s(e.backgroundImage)&&(e.backgroundColor="#fff"),~(a.length-1)&&a[a.length-1].fireEvent("blur"),t&&(e.tabGroup=(e.tab=t)._tabGroup),a.push(e),this._contentContainer._add(e),this._updateNavBar(),e._opened||e.fireEvent("open"),e._opened=1,e.fireEvent("focus")}},close:function(e){var a=this._windows,t=a.indexOf(e),i=this;e._navGroup=void 0,t>0&&(a.splice(t,1),e.fireEvent("blur"),i._contentContainer.remove(e),e.fireEvent("close"),e._opened=0,this._updateNavBar(),a[a.length-1].fireEvent("focus"))},_reset:function(){for(var e,a=this._windows,t=a.length-1,i=t;;){if(e=a[t],!t)break;t--===i&&e.fireEvent("blur"),this._contentContainer.remove(e),e.fireEvent("close"),e._opened=0}a.splice(1),this._updateNavBar(),e.fireEvent("focus")},constants:{window:void 0,bubbleParent:!1},properties:{navBarAtTop:{set:function(a,t){if(a!==t){var i=this._navBarContainer,n=i.domNode;this._remove(i),this._insertAt(i,a?0:1),e.remove(n,r+(a?"Top":"Bottom")),e.add(n,r+(a?"Bottom":"Top"))}return a}}}})});