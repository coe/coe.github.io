define(function(){var e={},a=[];return{dynamic:!0,normalize:function(e,a){var t=e.split("!"),i=t[0];return t.shift(),(/^\./.test(i)?a(i):i)+(t.length?"!"+t.join("!"):"")},load:function(t,i,n){var s,o,r,_,l=t.split("!"),d=l.length;if((_=d>1&&"sandbox"===l[0])&&(l.shift(),t=l.join("!")),r=i.toUrl(/^\//.test(t)?t:"./"+t,a.length?{name:a[a.length-1]}:null),s=e[r]||i.cache(r),!s){if(o=new XMLHttpRequest,o.open("GET",r,!1),o.send(null),200!==o.status)throw Error('Failed to load include "'+r+'": '+o.status);s=o.responseText}a.push(r);try{i.evaluate(e[r]=s,0,!_)}catch(c){throw c}finally{a.pop()}n(s)}}});