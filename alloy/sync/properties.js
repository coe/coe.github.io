function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}function Sync(t,e,i){var r=e.config.adapter.collection_name?e.config.adapter.collection_name:"default",o=new RegExp("^("+r+")\\-(.+)$"),n=null;if("read"===t)if(e instanceof Backbone.Collection){var s=[];_.each(TAP.listProperties(),function(t){var e=t.match(o);null!==e&&s.push(TAP.getObject(t))}),n=s}else{var a=TAP.getObject(r+"-"+e.id);e.set(a),n=e.toJSON()}else"create"===t||"update"===t?(e.id||(e.id=guid(),e.set(e.idAttribute,e.id)),TAP.setObject(r+"-"+e.id,e.toJSON()||{}),n=e.toJSON()):"delete"===t&&(TAP.removeProperty(r+"-"+e.id),e.clear(),n=e.toJSON());n?(_.isFunction(i.success)&&i.success(n),"read"===t&&e.trigger("fetch")):_.isFunction(i.error)&&i.error(n)}var Alloy=require("alloy"),_=require("alloy/underscore")._,TAP=Ti.App.Properties;module.exports.sync=Sync,module.exports.beforeModelCreate=function(t){return t=t||{},t.columns=t.columns||{},t.defaults=t.defaults||{},("undefined"==typeof t.columns.id||null===t.columns.id)&&(t.columns.id="String"),t};