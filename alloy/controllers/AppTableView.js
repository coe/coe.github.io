function __processArg(t,e){var i=null;return t&&(i=t[e]||null,delete t[e]),i}function Controller(){function t(e){if(!e||!e.fromAdapter){t.opts||{};for(var r=n.models,o=r.length,s=[],a=0;o>a;a++){var l=r[a];l.__transform=_.isFunction(l.transform)?l.transform():l.toJSON();var c=Ti.UI.createTableViewRow({className:"AppTableViewController",trackId:_.template("{m.trackId}",{m:l.__transform},{interpolate:/\{([\s\S]+?)\}/g}),height:60});s.push(c);var d=Ti.UI.createImageView({image:_.template("{m.artworkUrl60}",{m:l.__transform},{interpolate:/\{([\s\S]+?)\}/g}),left:0,height:60,width:60});c.add(d);var u=Ti.UI.createLabel({text:_.template("{m.trackCensoredName}",{m:l.__transform},{interpolate:/\{([\s\S]+?)\}/g}),left:64,right:60});c.add(u);var h=Ti.UI.createLabel({text:_.template("{m.primaryGenreName}",{m:l.__transform},{interpolate:/\{([\s\S]+?)\}/g}),right:0,top:0,height:30,width:60});c.add(h);var p=Ti.UI.createLabel({text:_.template("{m.formattedPrice}",{m:l.__transform},{interpolate:/\{([\s\S]+?)\}/g}),right:0,bottom:0,height:30,width:60});c.add(p)}i.__views.tableview.setData(s)}}function e(){window.twttr=function(t,e,i){var r,o=t.getElementsByTagName(e)[0],n=window.twttr||{};if(!t.getElementById(i))return r=t.createElement(e),r.id=i,r.src="https://platform.twitter.com/widgets.js",o.parentNode.insertBefore(r,o),n._e=[],n.ready=function(t){n._e.push(t)},n}(document,"script","twitter-wjs"),!function(t,e,i){var r,o=t.getElementsByTagName(e)[0];t.getElementById(i)||(r=t.createElement(e),r.id=i,r.src="//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.0",o.parentNode.insertBefore(r,o))}(document,"script","facebook-jssdk");var t=document.createElement("script");t.type="text/javascript",t.src="https://apis.google.com/js/platform.js",t.async=!0,document.getElementsByTagName("head")[0].appendChild(t);var t=document.createElement("script");t.type="text/javascript",t.src="https://b.st-hatena.com/js/bookmark_button.js",t.async=!0,document.getElementsByTagName("head")[0].appendChild(t),!function(t,e){if(!t.getElementById(e)){var i=t.createElement("script");i.id=e,i.src="https://widgets.getpocket.com/v1/j/btn.js?v=1",t.getElementById(e),t.body.appendChild(i)}}(document,"pocket-btn-js")}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="AppTableView",this.args=arguments[0]||{},arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var i=this,r={},o={};Alloy.Collections.instance("Apps"),i.__views.tableview=Ti.UI.createTableView({top:0,bottom:40,id:"tableview"});var n=Alloy.Collections.Apps||s;n.on("fetch destroy change add remove reset",t),i.__views.tableview&&i.addTopLevelView(i.__views.tableview),p?i.addListener(i.__views.tableview,"click",p):o["$.__views.tableview!click!onClickTable"]=!0,i.__views.AppTableView=Ti.UI.createView({bottom:0,height:40,layout:"horizontal",id:"AppTableView"}),i.__views.AppTableView&&i.addTopLevelView(i.__views.AppTableView),i.__views.contacts=Ti.UI.createView({layout:"horizontal",width:"60%",id:"contacts"}),i.__views.AppTableView.add(i.__views.contacts),i.__views.__alloyId20=Ti.UI.createButton({left:4,title:"Contact",id:"__alloyId20"}),i.__views.contacts.add(i.__views.__alloyId20),h?i.addListener(i.__views.__alloyId20,"click",h):o["$.__views.__alloyId20!click!onClickEmail"]=!0,i.__views.twitter_web=Ti.UI.createWebView({left:4,height:20,width:145,html:"<a href=\"https://twitter.com/coffeegyunyu\" class=\"twitter-follow-button\" data-show-count=\"false\">Follow @coffeegyunyu</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>",id:"twitter_web"}),i.__views.contacts.add(i.__views.twitter_web),i.__views.share_buttons=Ti.UI.createView({layout:"horizontal",width:"40%",id:"share_buttons"}),i.__views.AppTableView.add(i.__views.share_buttons),i.__views.twitter_page=Ti.UI.createWebView({left:4,height:20,width:75,html:"<a href=\"https://twitter.com/share\" class=\"twitter-share-button\">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>",id:"twitter_page"}),i.__views.share_buttons.add(i.__views.twitter_page),r.destroy=function(){n&&n.off("fetch destroy change add remove reset",t)},_.extend(i,i.__views);var s,a,l,c,d,u,h,p,f;c="AppTableView",a="http://itunes.apple.com/search?term=tsuyoshi+hyuga&country="+Ti.Locale.getCurrentCountry()+"&media=software&entity=software",l=require("Itunes"),d=["coe.app@gmail.com"],s=Alloy.Collections.instance("Apps"),f=function(t){return console.log(c+" transformFunction "+t)},u=function(t){return t.sort},p=function(t){var e,i;return console.log(c+" onClickTable "+t.rowData.trackId),e=Alloy.Collections.Apps.where({trackId:t.rowData.trackId})[0],i=Alloy.createController("AppDescriptionController",e.toJSON()).getView(),Alloy.Navigation.open(i,{animated:!0})},h=function(){var t;return t=Ti.UI.createEmailDialog(),t.toRecipients=d,t.open()},!function(){return setTimeout(function(){for(console.log(c+" onClickButton"),Alloy.Collections.Apps.fetch();Alloy.Collections.Apps.length;)console.log(c+" Alloy.Collections.Apps.length "+Alloy.Collections.Apps.length),Alloy.Collections.Apps.at(0).destroy();return l.getItunesData(a,function(e){var i,r,o,n,s;for(console.log(c+" Itunes.getItunesData "+e),r=i=0,o=e.length;o>i;r=++i)s=e[r],console.log(c+" value "+JSON.stringify(s)),n=Alloy.createModel("Apps",s),n.save();return console.log(c+" Alloy.Collections.Apps.length "+Alloy.Collections.Apps.length),Alloy.Collections.Apps.fetch(),console.log(c+" Alloy.Collections.Apps.length.fetch "+Alloy.Collections.Apps.length),t()},function(){return console.error(c+" Itunes.getItunesData error "+data)})},1)}(),window.addEventListener?window.addEventListener("load",e,!1):window.attachEvent("onload",e),o["$.__views.tableview!click!onClickTable"]&&i.addListener(i.__views.tableview,"click",p),o["$.__views.__alloyId20!click!onClickEmail"]&&i.addListener(i.__views.__alloyId20,"click",h),_.extend(i,r)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;