var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["External Unlink"]=function(e){function t(e){Cloud.SocialIntegrations.externalAccountUnlink({id:e.source.accountID,type:e.source.accountType},function(t){t.success?(alert("Unlinked from "+e.source.accountType+"!"),r.remove(e.source)):Utils.error(t)})}var i=WindowManager.createWindow({backgroundColor:"white"}),r=Ti.UI.createScrollView({top:0,contentHeight:"auto",layout:"vertical"});i.add(r);var o=Ti.UI.createLabel({text:"Loading, please wait...",textAlign:"center",top:0,right:0,bottom:0,left:0,backgroundColor:"#fff",zIndex:2});return i.add(o),i.addEventListener("open",function(){Cloud.Users.showMe(function(e){if(o.hide(),e.success){var i=e.users[0];if(0==i.external_accounts.length)alert("No linked accounts");else for(var n=0;n<i.external_accounts.length;n++){var a=Ti.UI.createButton({title:"Unlink from "+i.external_accounts[n].external_type,top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,bottom:10+Utils.u,height:40+Utils.u,accountType:i.external_accounts[n].external_type,accountID:i.external_accounts[n].external_id});a.addEventListener("click",t),r.add(a)}}else Utils.error(e)})}),i};