var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["External Login"]=function(e){function t(){i.loggedIn?(n.text="Logging in to ACS as well, please wait...",Cloud.SocialIntegrations.externalAccountLogin({type:"facebook",token:i.accessToken},function(e){if(e.success){var t=e.users[0];alert("Logged in! You are now logged in as "+t.id)}else Utils.error(e)})):n.text="Please login to Facebook."}var i=Ti.Facebook?Ti.Facebook:require("facebook"),r=WindowManager.createWindow({backgroundColor:"white"}),o=Ti.UI.createScrollView({top:0,contentHeight:"auto",layout:"vertical"});r.add(o),i.appid="<<YOUR FACEBOOK APPID HERE>>",i.permissions=["publish_stream","read_stream"];var n=Ti.UI.createLabel({textAlign:"center",top:10+Utils.u,right:10+Utils.u,left:10+Utils.u,height:"auto"});return o.add(n),o.add(i.createLoginButton({top:10+Utils.u,style:"iPhone OS"==Ti.Platform.name?i.BUTTON_STYLE_WIDE:"wide"})),r.addEventListener("open",function(e){i.addEventListener("login",t),i.addEventListener("logout",t),t()}),r.addEventListener("close",function(e){i.removeEventListener("login",t),i.removeEventListener("logout",t)}),r};