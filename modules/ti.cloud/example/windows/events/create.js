var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Create Event"]=function(e){function t(){c.hide();var e,t={name:n.value};if(e=Date.parse(o.value+" "+a.value),isNaN(e))return alert("Please enter a valid date/time"),void o.focus();if(t.start_time=new Date(e),e=parseInt(s.value,10),isNaN(e)||(t.duration=e),l.value.length>0){t.recurring=l.value.toLowerCase();var i={daily:1,weekly:1,monthly:1,yearly:1};if(!i[t.recurring])return alert("Enter 'daily', 'weekly', 'monthly', or 'yearly'"),void l.focus()}e=parseInt(u.value,10),isNaN(e)||(t.recurring_count=e),Cloud.Events.create(t,function(e){e.success?(alert("Created!"),n.value=o.value=a.value=s.value=l.value=u.value=""):Utils.error(e),c.show()})}var i=WindowManager.createWindow({backgroundColor:"white"}),r=Ti.UI.createScrollView({top:0,contentHeight:"auto",layout:"vertical"});i.add(r);var n=Ti.UI.createTextField({hintText:"Name",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});r.add(n);var o=Ti.UI.createTextField({hintText:"Date",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});r.add(o);var a=Ti.UI.createTextField({hintText:"Time",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});r.add(a);var s=Ti.UI.createTextField({hintText:"Duration (seconds)",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD});r.add(s);var l=Ti.UI.createTextField({hintText:"Recurring",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,autocapitalization:Ti.UI.TEXT_AUTOCAPITALIZATION_NONE});r.add(l);var u=Ti.UI.createTextField({hintText:"Recurring Count (0-1000)",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD});r.add(u);var c=Ti.UI.createButton({title:"Create",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,bottom:10+Utils.u,height:40+Utils.u});r.add(c),c.addEventListener("click",t);for(var d=[n,o,a,s,l,u],p=0;p<d.length;p++)d[p].addEventListener("return",t);return i.addEventListener("open",function(){n.focus()}),i};