var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Update File"]=function(e){function t(){s.hide(),Ti.UI.createProgressBar&&(n.value=0,Cloud.onsendstream=function(e){n.value=.5*e.progress},Cloud.ondatastream=function(e){n.value=.5*e.progress+.5});var t={file_id:e.id};""!=o.value&&(t.name=o.value),""!=a.value&&(t.file=Titanium.Filesystem.getFile(Ti.Filesystem.resourcesDirectory,"/windows/files/"+a.value)),Cloud.Files.update(t,function(e){Cloud.onsendstream=Cloud.ondatastream=null,e.success?alert("Updated!"):Utils.error(e),s.show()})}var i=WindowManager.createWindow({backgroundColor:"white"}),r=Ti.UI.createScrollView({top:0,contentHeight:"auto",layout:"vertical"});if(i.add(r),Ti.UI.createProgressBar){var n=Ti.UI.createProgressBar({top:10+Utils.u,right:10+Utils.u,left:10+Utils.u,max:1,min:0,value:0,height:25+Utils.u});r.add(n),n.show()}var o=Ti.UI.createTextField({hintText:"Name",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});r.add(o);var a=Ti.UI.createTextField({hintText:"File name",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});r.add(a);var s=Ti.UI.createButton({title:"Update",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,bottom:10+Utils.u,height:40+Utils.u});r.add(s),s.addEventListener("click",t);for(var l=[o,a],u=0;u<l.length;u++)l[u].addEventListener("return",t);return i.addEventListener("open",function(){o.focus()}),i};