var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Login User"]=function(e){function t(){for(var e=0;e<s.length;e++){if(!s[e].value.length)return void s[e].focus();s[e].blur()}a.hide(),Cloud.Users.login({login:o.value,password:n.value},function(e){if(e.success){var t=e.users[0];o.value=n.value="",alert("Logged in! You are now logged in as "+t.id)}else Utils.error(e);a.show()})}var i=WindowManager.createWindow({backgroundColor:"white"}),r=Ti.UI.createScrollView({top:0,contentHeight:Ti.UI.SIZE,layout:"vertical"});i.add(r);var o=Ti.UI.createTextField({hintText:"Login",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,autocapitalization:Ti.UI.TEXT_AUTOCAPITALIZATION_NONE,autocorrect:!1});r.add(o);var n=Ti.UI.createTextField({hintText:"Password",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,passwordMask:!0});r.add(n);var a=Ti.UI.createButton({title:"Login User",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u});Utils.blackberry||(a.bottom=10+Utils.u),r.add(a);var s=[o,n];a.addEventListener("click",t);for(var l=0;l<s.length;l++)s[l].addEventListener("return",t);return i.addEventListener("open",function(){o.focus()}),i};