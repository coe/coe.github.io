var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Approve Friends"]=function(e){function t(){Cloud.Friends.requests(function(e){if(e.success)if(0==e.friend_requests.length)n.setData([{title:"No friend requests"}]);else{var t=[];t.push({title:"Approve Friend Requests!"});for(var i=0,r=e.friend_requests.length;r>i;i++){var o=e.friend_requests[i].user,a=Ti.UI.createTableViewRow({title:o.first_name+" "+o.last_name,id:o.id});t.push(a)}n.setData(t)}else n.setData([{title:e.error&&e.message||e}]),Utils.error(e)})}var i=WindowManager.createWindow({backgroundColor:"white"}),r=[],n=Ti.UI.createTableView({backgroundColor:"#fff",top:0,bottom:0,data:[{title:"Loading, please wait..."}]});return n.addEventListener("click",function(e){e.row.id?(e.row.hasCheck=!e.row.hasCheck,e.row.hasCheck?r.push(e.row.id):r.splice(r.indexOf(e.row.id),1)):0==r.length?alert("No users selected"):Cloud.Friends.approve({user_ids:r.join(",")},function(e){e.success?alert("Friend(s) approved"):Utils.error(e)})}),i.add(n),i.addEventListener("open",t),i};