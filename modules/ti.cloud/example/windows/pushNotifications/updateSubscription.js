var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Update Subscription"]=function(e){function t(){for(var e=0;e<u.length;e++){if(!u[e].value.length)return void u[e].focus();u[e].blur()}l.hide(),Cloud.PushNotifications.updateSubscription({device_token:Utils.pushDeviceToken,loc:[parseFloat(s.value),parseFloat(a.value)]},function(e){e.success?alert("Subscription Updated! "+Utils.pushDeviceToken):Utils.error(e),l.show()})}var i=WindowManager.createWindow({backgroundColor:"white"}),r=Ti.UI.createScrollView({top:0,contentHeight:"auto",layout:"vertical"});if(i.add(r),!Utils.pushDeviceToken)return r.add(Ti.UI.createLabel({text:"Please visit Push Notifications > Settings to enable push!",textAlign:"center",color:"#000",height:"auto"})),i;var o="37.3895100",n="-122.0502150",a=Ti.UI.createTextField({hintText:"Latitude",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,autocapitalization:Ti.UI.TEXT_AUTOCAPITALIZATION_NONE,autocorrect:!1,value:o});r.add(a);var s=Ti.UI.createTextField({hintText:"Longitude",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,autocapitalization:Ti.UI.TEXT_AUTOCAPITALIZATION_NONE,autocorrect:!1,value:n});r.add(s);var l=Ti.UI.createButton({title:"Update",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,bottom:10+Utils.u,height:40+Utils.u});r.add(l);var u=[s,a];l.addEventListener("click",t);for(var d=0;d<u.length;d++)u[d].addEventListener("return",t);return i.addEventListener("open",function(){a.focus()}),i};