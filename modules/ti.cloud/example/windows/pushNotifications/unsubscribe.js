var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports.Unsubscribe=function(e){function t(){for(var e=0;e<a.length;e++)a[e].blur();n.hide();var t={device_token:Utils.pushDeviceToken};o.value&&o.value.length&&(t.channel=o.value),Cloud.PushNotifications.unsubscribe(t,function(e){e.success?(o.value="",alert("Unsubscribed!")):Utils.error(e),n.show()})}var i=WindowManager.createWindow({backgroundColor:"white"}),r=Ti.UI.createScrollView({top:0,contentHeight:"auto",layout:"vertical"});if(i.add(r),!Utils.pushDeviceToken)return r.add(Ti.UI.createLabel({text:"Please visit Push Notifications > Settings to enable push!",textAlign:"center",color:"#000",height:"auto"})),i;var o=Ti.UI.createTextField({hintText:"Channel (leave blank for all)",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,autocapitalization:Ti.UI.TEXT_AUTOCAPITALIZATION_NONE,autocorrect:!1});r.add(o);var n=Ti.UI.createButton({title:"Unsubscribe",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,bottom:10+Utils.u,height:40+Utils.u});r.add(n);var a=[o];n.addEventListener("click",t);for(var s=0;s<a.length;s++)a[s].addEventListener("return",t);return i.addEventListener("open",function(){o.focus()}),i};