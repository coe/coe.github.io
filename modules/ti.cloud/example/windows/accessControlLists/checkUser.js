var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Check Permission of ACL"]=function(e){function t(){Cloud.Users.query(function(e){if(e.success)if(0==e.users.length)o.setData([{title:"No Users!"}]);else{for(var t=[],r=0,i=e.users.length;i>r;r++){var n=e.users[r],s=Ti.UI.createTableViewRow({title:n.first_name+" "+n.last_name,id:n.id});t.push(s)}o.setData(t)}else o.setData([{title:e.error&&e.message||e}]),Utils.error(e)})}var r=WindowManager.createWindow({backgroundColor:"white"}),i=Ti.UI.createScrollView({top:0,contentHeight:"auto",layout:"vertical"});r.add(i);var n=Ti.UI.createTextField({hintText:"Name",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,autocapitalization:Ti.UI.TEXT_AUTOCAPITALIZATION_NONE,autocorrect:!1});i.add(n);var o=Ti.UI.createTableView({backgroundColor:"#fff",top:0,bottom:0,data:[{title:"Loading, please wait..."}]});return o.addEventListener("click",function(e){return 0==n.value.length?void n.focus():void(e.row.id&&Cloud.ACLs.checkUser({name:n.value,user_id:e.row.id},function(e){e.success?alert("Read Permission: "+(e.permission.read_permission||"no")+"\nWrite Permission: "+(e.permission.write_permission||"no")):Utils.error(e)}))}),i.add(o),r.addEventListener("open",function(){t()}),r};