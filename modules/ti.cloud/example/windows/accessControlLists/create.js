var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Create ACL"]=function(e){var t=WindowManager.createWindow({backgroundColor:"white"}),i=Ti.UI.createScrollView({top:0,contentHeight:"auto",layout:"vertical"});t.add(i);var r=Ti.UI.createTextField({hintText:"Name",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,height:40+Utils.u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,autocapitalization:Ti.UI.TEXT_AUTOCAPITALIZATION_NONE,autocorrect:!1});i.add(r);var n={publicAccess:!1,ids:[]},o=Ti.UI.createButton({title:"Select Readers",top:10+Utils.u,left:10+Utils.u,right:10+Utils.u,bottom:10+Utils.u,height:40+Utils.u});o.addEventListener("click",function(){WindowManager.handleOpenWindow({target:"Select Users for ACL",access:n})}),i.add(o);var s={publicAccess:!1,ids:[]},a=Ti.UI.createButton({title:"Select Writers",top:0,left:10+Utils.u,right:10+Utils.u,bottom:10+Utils.u,height:40+Utils.u});a.addEventListener("click",function(e){WindowManager.handleOpenWindow({target:"Select Users for ACL",access:s})}),i.add(a);var l=Ti.UI.createButton({title:"Create",top:0,left:10+Utils.u,right:10+Utils.u,bottom:10+Utils.u,height:40+Utils.u});return l.addEventListener("click",function(e){return 0==r.value.length?void r.focus():(l.hide(),void Cloud.ACLs.create({name:r.value,reader_ids:n.ids.join(","),writer_ids:s.ids.join(","),public_read:n.publicAccess,public_write:s.publicAccess},function(e){e.success?alert("Created!"):Utils.error(e),l.show()}))}),i.add(l),t.addEventListener("open",function(){r.focus()}),t};