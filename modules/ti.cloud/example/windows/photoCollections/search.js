var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Search Photo Collections"]=function(e){function t(e){Cloud.PhotoCollections.search({user_id:e},function(e){if(e.success)if(0==e.collections.length)n.setData([{title:"No Results!"}]);else{for(var t=[],i=0,r=e.collections.length;r>i;i++)t.push(Ti.UI.createTableViewRow({title:e.collections[i].name,id:e.collections[i].id}));n.setData(t)}else Utils.error(e)})}function i(){Cloud.Users.showMe(function(e){e.success?t(e.users[0].id):(n.setData([{title:e.error&&e.message||e}]),Utils.error(e))})}var r=WindowManager.createWindow({backgroundColor:"white"}),n=Ti.UI.createTableView({backgroundColor:"#fff",top:0,bottom:0,data:[{title:"Loading, please wait..."}]});return n.addEventListener("click",function(e){e.row.id&&WindowManager.handleOpenWindow({target:"Show Photo Collection",id:e.row.id})}),r.add(n),r.addEventListener("open",function(){i()}),r};