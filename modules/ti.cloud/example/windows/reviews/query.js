var WindowManager=require("helper/WindowManager"),Utils=require("helper/Utils"),Cloud=require("ti.cloud");exports["Query Review"]=function(e){var t=WindowManager.createWindow({backgroundColor:"white"}),i=Ti.UI.createTableView({backgroundColor:"#fff",top:0,bottom:0,data:[{title:"Loading, please wait..."}]});i.addEventListener("click",function(e){e.row.id&&WindowManager.handleOpenWindow({target:"Show Review",user_id:o,review_id:e.row.id})}),t.add(i);var r=Ti.UI.createLabel({text:"Loading, please wait...",textAlign:"center",color:"#000",backgroundColor:"#fff",top:0});t.add(r);var o;return Cloud.Users.showMe(function(e){e.success?(t.remove(r),o=e.users[0].id,Cloud.Reviews.query({user_id:o},function(e){if(e.success)if(0==e.reviews.length)i.setData([{title:"No Results!"}]);else{for(var t=[],r=0,o=e.reviews.length;o>r;r++)t.push(Ti.UI.createTableViewRow({title:e.reviews[r].rating+", "+e.reviews[r].content,id:e.reviews[r].id}));i.setData(t)}else Utils.error(e)})):(Utils.error(e),r.text=e.error&&e.message||e)}),t};