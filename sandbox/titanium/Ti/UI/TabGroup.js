define(["Ti/_/declare","Ti/_/UI/SuperView","Ti/UI/View","Ti/UI","Ti/_/lang"],function(e,a,t,i,n){var s=require.is,o=i.FILL,r={post:"_updateTabsBackground"};return e("Ti.UI.TabGroup",a,{constructor:function(a){var s=this,r=(s.constants.tabsAtBottom=n.val(a&&a.tabsAtBottom,s.constants.tabsAtBottom),e(t,{declaredClass:"Ti.UI.TabBarContainer"}));s._tabBarContainer=new r({width:o,layout:i._LAYOUT_CONSTRAINING_HORIZONTAL}),s.tabHeight=75,s._tabContentContainer=i.createView({width:o,height:o}),s.layout=i._LAYOUT_CONSTRAINING_VERTICAL,s.tabs=[],s.tabsAtBottom=n.val(a&&a.tabsAtBottom,!0)},addTab:function(e){var a=this.tabs;a.push(e),e._setTabGroup(this),1===a.length?this.activeTab=e:this._tabBarContainer._add(this._createTabDivider()),this._tabBarContainer._add(e),this._updateTabBackground(e),this._publish(e)},_addTabContents:function(e){this._tabContentContainer._add(e)},_removeTabContents:function(e){this._tabContentContainer._remove(e)},removeTab:function(e){var a=this.tabs,t=this.tabs.indexOf(e);t>=0&&(a.splice(t,1),this._tabBarContainer.remove(e),e===this._activeTab&&this._activateTab(a[0]),this._unpublish(e))},_createTabDivider:function(){return i.createView({width:this.tabDividerWidth,height:o,backgroundColor:this.tabDividerColor})},close:function(){this._previousTab=null,a.prototype.close.call(this)},_getEventData:function(){var e=this.tabs,a=this._previousTab,t=this._activeTab;return{index:t&&e.indexOf(t),previousIndex:a&&e.indexOf(a),tab:t,previousTab:a}},_handleFocusEvent:function(){var e=this._previousTab,a=this._activeTab;e&&e._blur(),!this._focused&&this._opened&&(this.fireEvent("focus",this._getEventData()),a&&a._focus()),this._focused=1},_handleBlurEvent:function(e){if(e){for(var a,t=0,i=this.tabs.length;i>t;)a=this.tabs[t++],(2!==e||a===this._activeTab)&&a._blur();this._previousTab=void 0}this._focused&&this._opened&&this.fireEvent("blur",this._getEventData()),this._focused=0},_activateTab:function(e){var a=(this.tabs,this._activeTab);a!==e&&((this._previousTab=a)&&(a.active=!1,a._doBackground()),i.currentTab=this._activeTab=e,e.active=!0,this._updateTabsBackground())},_updateTabBackground:function(e){var a=e.active?"activeTab":"tabs";["","Focused","Disabled","Selected"].forEach(function(t){t="Background"+t,e["_default"+t+"Color"]=this[a+t+"Color"],e["_default"+t+"Image"]=this[a+t+"Image"]},this),e._doBackground()},_updateTabsBackground:function(){for(var e=this.tabs,a=0,t=e.length;t>a;)this._updateTabBackground(e[a++])},_updateDividers:function(){for(var e=this._tabBarContainer._children,a=1;e.length>a;a+=2){var t=e[a];t.width=this.tabDividerWidth,t.backgroundColor=this.tabDividerColor}},_defaultWidth:o,_defaultHeight:o,constants:{bubbleParent:!1},properties:{activeTab:{set:function(e){return s(e,"Number")&&(e=this.tabs[e]),!e in this.tabs?void 0:e},post:function(e){n.isDef(e)&&this._activateTab(e)}},tabs:{set:function(e){if(s(e,"Array")){var a,t=this._tabBarContainer;if(t._removeAllChildren(),e.length)for(a=0;e.length>a;a++)e[a]._setTabGroup(this),0==a&&this._activateTab(this.activeTab=e[a]),this._publish(e[a]),a&&t._add(this._createTabDivider()),t._add(e[a]);return e}},post:"_updateTabsBackground"},tabsAtBottom:{set:function(e,a){if(e!==a){var t=this._tabContentContainer,i=this._tabBarContainer;this._activeTab&&this._activeTab._setNavBarAtTop(e),this._remove(t),this._remove(i),e?(this._add(t),this._add(i)):(this._add(i),this._add(t))}return e}},activeTabBackgroundColor:{post:"_updateTabsBackground",value:"#fff"},activeTabBackgroundImage:r,activeTabBackgroundDisabledColor:{post:"_updateTabsBackground",value:"#888"},activeTabBackgroundDisabledImage:r,activeTabBackgroundFocusedColor:{post:"_updateTabsBackground",value:"#ccc"},activeTabBackgroundFocusedImage:r,activeTabBackgroundSelectedColor:{post:"_updateTabsBackground",value:"#ddd"},activeTabBackgroundSelectedImage:r,tabsBackgroundColor:{post:"_updateTabsBackground",value:"#aaa"},tabsBackgroundImage:r,tabsBackgroundDisabledColor:{post:"_updateTabsBackground",value:"#666"},tabsBackgroundDisabledImage:r,tabsBackgroundFocusedColor:{post:"_updateTabsBackground",value:"#ccc"},tabsBackgroundFocusedImage:r,tabsBackgroundSelectedColor:{post:"_updateTabsBackground",value:"#ddd"},tabsBackgroundSelectedImage:r,tabDividerColor:{post:"_updateDividers",value:"#555"},tabDividerWidth:{post:"_updateDividers",value:1},tabHeight:{set:function(e){return this._tabBarContainer.height=e,e}}}})});