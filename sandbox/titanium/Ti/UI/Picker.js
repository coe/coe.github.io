define(["Ti/_/declare","Ti/_/event","Ti/_/has","Ti/UI/View","Ti/_/UI/Widget","Ti/UI","Ti/_/lang","Ti/_/dom","Ti/_/ready"],function(e,a,t,i,n,s,o,r,_){var l=require.is,d=6,c=r.unitize(d),u={},p=require.on,m=e(n,{constructor:function(){function e(){a!==i.value&&(a=i.value,n.fireEvent("change",{value:i.valueAsDate}))}var a,i=this._input=r.create("input",{style:{left:c,top:c,right:c,bottom:c,position:"absolute"}},this.domNode),n=this;n._handles=[p(i,t("touch")?"touchend":"click",e),p(i,"keyup",e)]},destroy:function(){a.off(this._handles),n.prototype.destroy.apply(this,arguments)},_getContentSize:function(){return u[this.type]},properties:{type:{set:function(e){return this._input.type=e}},min:{set:function(e){return this._input.min=o.val(e,""),e}},max:{set:function(e){return this._input.max=o.val(e,""),e}},value:{set:function(e){try{this._input.valueAsDate=e}catch(a){}}}}});return _(function(){var e=r.create("input",{style:{height:s.SIZE,width:s.SIZE}},document.body);["Date","Time","DateTime"].forEach(function(a){try{e.type=a}catch(t){}u[a]={width:e.clientWidth+2*d,height:e.clientHeight+2*d}}),r.detach(e)}),e("Ti.UI.Picker",i,{constructor:function(){this.layout="constrainingHorizontal",this._columns=[],this._getBorderFromCSS()},_currentColumn:null,_addColumn:function(e){this._columns.push(e),e._parentPicker=this;for(var a=0,t=this._columns.length,i=this.width===s.SIZE?s.SIZE:100/t+"%",n=this.height===s.SIZE?s.SIZE:"100%";t>a;a++)e=this._columns[a],e.width=i,e.height=n,e._setCorners(0===a,a===t-1,c);e._pickerChangeEventListener=o.hitch(this,function(e){var a={column:e.column,columnIndex:this._columns.indexOf(e.column),row:e.row,rowIndex:e.rowIndex};if(this.type===s.PICKER_TYPE_PLAIN){var t=[];for(var i in this._columns){var n=this._columns[i].selectedRow;n&&t.push(n.title)}a.selectedValue=t}this.fireEvent("change",a)}),e.addEventListener("change",e._pickerChangeEventListener),this._add(e),this._publish(e)},_updateColumnHeights:function(){var e,a=0;for(e in this._columns)a=Math.max(a,this._columns[e]._getTallestRowHeight());for(e in this._columns)this._columns[e]._setTallestRowHeight(a)},_defaultWidth:s.SIZE,_defaultHeight:s.SIZE,add:function(e){if(l(e,"Array"))for(var a in e)this.add(e[a]);else o.isDef(e.declaredClass)&&("Ti.UI.PickerColumn"===e.declaredClass?this._addColumn(e):"Ti.UI.PickerRow"===e.declaredClass&&(null===this._currentColumn&&this._addColumn(this._currentColumn=s.createPickerColumn()),this._currentColumn.addRow(e)))},destroy:function(){this._dateTimeInput&&this._dateTimeInput.destroy(),n.prototype.destroy.apply(this,arguments)},getSelectedRow:function(e){var a=this._columns[e];return a&&a.selectedRow},setSelectedRow:function(e,a){var t=this._columns[e];t&&(t.selectedRow=t.rows[a])},properties:{columns:{get:function(){return this._columns},set:function(e){this._removeAllChildren();for(var a in this._columns){var t=this._columns[a];t.removeEventListener(t._pickerChangeEventListener),t._parentPicker=void 0}this._columns=[],e&&this.add(e)}},maxDate:{set:function(e){return this._dateTimeInput&&(this._dateTimeInput.max=e),e}},minDate:{set:function(e){return this._dateTimeInput&&(this._dateTimeInput.min=e),e}},type:{set:function(e,a){function t(e){var a=i._dateTimeInput=new m({type:e,width:s.INHERIT,height:s.INHERIT});a.addEventListener("change",function(e){i.properties.__values__.value=e.value,i.fireEvent("change",e)}),a.min=i.min,a.max=i.max,i._add(a)}var i=this;if(e!==a)switch(this.columns=void 0,this._dateTimeInput=null,e){case s.PICKER_TYPE_DATE:t("Date");break;case s.PICKER_TYPE_TIME:t("Time");break;case s.PICKER_TYPE_DATE_AND_TIME:t("DateTime")}return e},value:s.PICKER_TYPE_PLAIN},value:{set:function(e){return this._dateTimeInput&&(this._dateTimeInput.value=e),e}}}})});