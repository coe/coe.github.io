define(["Ti/_/declare","Ti/_/dom","Ti/_/event","Ti/_/style","Ti/_/lang","Ti/_/UI/FontWidget","Ti/UI"],function(e,a,t,i,n,s,o){var r=require.on,_=i.set;return e("Ti._.UI.TextBox",s,{constructor:function(){this._addEventModifier(["click","singletap","blur","change","focus","return"],function(e){e.value=this._getInternalText()})},_initTextBox:function(e){this._field=e;var a=null,i="";this._addStyleableDomNode(this._setFocusNode(e)),r(e,"keydown",this,function(a){return this.editable?(13===a.keyCode&&(this.suppressReturn&&(t.stop(a),e.blur()),this.fireEvent("return")),void 0):(t.stop(a),!1)}),r(e,"keypress",this,function(){setTimeout(n.hitch(this,function(){this._capitalize()}))}),r(e,"focus",this,function(){this.fireEvent("focus"),a=setInterval(n.hitch(this,function(){var a=e.value;(i.length!==a.length||i!==a)&&(this.fireEvent("change"),i=a)}),200)}),r(e,"blur",this,function(){clearInterval(a),this.fireEvent("blur")}),this.autocorrect=!0},_setInternalText:function(e){this._field.value!==e&&(this._field.value=e,this._capitalize())},_getInternalText:function(){return this._field.value},_updateInternalText:function(){this._setInternalText(this._getInternalText())},_capitalize:function(){var e="off",a=this._field;switch(this.autocapitalization){case o.TEXT_AUTOCAPITALIZATION_ALL:a.value=a.value.toUpperCase();break;case o.TEXT_AUTOCAPITALIZATION_SENTENCES:e="on"}this._field.autocapitalize=e},blur:function(){this._field.blur()},focus:function(){this._field.focus()},hasText:function(){return!!this._field.value},properties:{autocapitalization:{value:o.TEXT_AUTOCAPITALIZATION_SENTENCES,post:"_capitalize"},autocorrect:{post:function(e){this._field.autocorrect=e?"on":"off"}},editable:!0,maxLength:{set:function(e){return e=Math.max(0|e,0),a.attr[e>0?"set":"remove"](this._field,"maxlength",e),e}},returnKeyType:function(){return o.RETURNKEY_DEFAULT},suppressReturn:!0,textAlign:{post:function(e){_(this._field,"textAlign",/(center|right)/.test(e)?e:"left")}},value:{get:function(){return this._getInternalText()},post:"_setInternalText",value:""}}})});