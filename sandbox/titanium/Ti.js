define(["Ti/_","Ti/API","Ti/_/analytics","Ti/App","Ti/_/Evented","Ti/_/has","Ti/_/lang","Ti/_/ready","Ti/_/style","Ti/Buffer","Ti/Platform","Ti/UI","Ti/Locale","Ti/_/include"],function(_,API,analytics,App,Evented,has,lang,ready,style,Buffer,Platform,UI){function Empty(){}function escapeString(e){return('"'+e.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")}function shutdown(){unloaded||(unloaded=1,App.fireEvent("close"),analytics.add("ti.end","ti.end"))}var global=window,req=require,cfg=req.config,deployType=App.deployType,ver=cfg.ti.version,is=req.is,on=req.on,loaded,unloaded,showingError,waiting=[],Ti=lang.setObject("Ti",Evented,{constants:{buildDate:cfg.ti.buildDate,buildHash:cfg.ti.buildHash,version:ver},properties:{userAgent:function(){return navigator.userAgent}},createBuffer:function(e){return new Buffer(e)},include:function(e){"array"==typeof e||(e=[].concat(Array.prototype.slice.call(arguments,0))),e.forEach(function(e){require("Ti/_/include!"+e)})},deferStart:function(){if(!loaded){var e=Math.round(1e12*Math.random());return waiting.push(e),function(){var a=waiting.indexOf(e);~a&&waiting.splice(a,1),loaded=1,waiting.length||(has("ti-instrumentation")&&instrumentation.stopTest(instrumentation.systemLoadTimeTest),require(cfg.main||["app.js"]))}}API.warn("app.js already loaded!")}}),loadAppjs=Ti.deferStart();if(!has("object-defineproperty")){var odp=Object.defineProperty;Object.defineProperty=function defineProperty(e,a,t){if(!e||!is(e,"Object")&&!is(e,"Function")&&!is(e,"Window"))throw new TypeError("Object.defineProperty called on non-object: "+e);if(t=t||{},!t||!is(t,"Object")&&!is(t,"Function"))throw new TypeError("Property description must be an object: "+t);if(odp)try{return odp.call(Object,e,a,t)}catch(i){}var n=Object.prototype,s=function(e,a){return e.hasOwnProperty(a)},o=s(n,"__defineGetter__"),r=e.__proto__;if(s(t,"value"))o&&(e.__lookupGetter__(a)||e.__lookupSetter__(a))?(e.__proto__=n,delete e[a],e[a]=t.value,e.__proto__=r):e[a]=t.value;else{if(!o)throw new TypeError("Getters and setters can not be defined on this javascript engine");s(t,"get")&&defineGetter(e,a,t.get),s(t,"set")?defineSetter(e,a,t.set):e[a]=null}}}if(has("function-bind")||(Function.prototype.bind=function bind(e){var a=this,t=Array.prototype.slice,i=t.call(arguments,1),n=function(){var s,o=i.concat(t.call(arguments));return this instanceof n?(s=a.apply(this,o),Object(s)===s?s:this):a.apply(e,o)};return a.prototype&&(Empty.prototype=a.prototype,n.prototype=new Empty,Empty.prototype=null),n}),!has("js-btoa")){var tab="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",fromCharCode=String.fromCharCode;global.btoa=function(e){for(var a,t,i,n,s,o,r,_=[],l=0,d=e.length;d>l;)a=e.charCodeAt(l++),t=e.charCodeAt(l++),i=e.charCodeAt(l++),n=a>>2,s=(3&a)<<4|t>>4,o=(15&t)<<2|i>>6,r=63&i,isNaN(t)?o=r=64:isNaN(i)&&(r=64),_.push(tab.charAt(n)+tab.charAt(s)+tab.charAt(o)+tab.charAt(r));return _.join("")},global.atob=function(e){var a,t,i,n,s=[],o=0,r=e.length;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");r>o;)a=tab.indexOf(e.charAt(o++)),t=tab.indexOf(e.charAt(o++)),i=tab.indexOf(e.charAt(o++)),n=tab.indexOf(e.charAt(o++)),s.push(fromCharCode(a<<2|t>>4)),64!==i&&s.push(fromCharCode((15&t)<<4|i>>2)),64!==n&&s.push(fromCharCode((3&i)<<6|n));return s.join("")}}return has("json-stringify")||(JSON.parse=function(s){return eval("("+s+")")},JSON.stringify=function(e,a,t){function i(e,n,s){var o,r,_=typeof e,l=t?n+t:"",d=t?" ":"",c=t?"\n":"",u=[];if(a&&(e=a(s,e)),"number"===_)return isFinite(e)?e+"":"null";if(is(_,"Boolean"))return e+"";if(null===e)return"null";if(is(e,"String"))return escapeString(e);if("function"===_||"undefined"===_)return void 0;if(is(e.toJSON,"Function"))return i(e.toJSON(s),n,s);if(e instanceof Date)return'"{FullYear}-{Month+}-{Date}T{Hours}:{Minutes}:{Seconds}Z"'.replace(/\{(\w+)(\+)?\}/g,function(a,t,i){var n=e["getUTC"+t]()+(i?1:0);return 10>n?"0"+n:n});if(e.valueOf()!==e)return i(e.valueOf(),n,s);if(e instanceof Array){for(s=0,r=e.length;r>s;s++){var p=e[s];o=i(p,l,s),is(o,"String")||(o="null"),u.push(c+l+o)}return"["+u.join(",")+c+n+"]"}for(s in e){var m;if(is(s,"Number"))m='"'+s+'"';else{if(!is(s,"String"))continue;m=escapeString(s)}o=i(e[s],l,s),is(o,"String")&&u.push(c+l+m+":"+d+o)}return"{"+u.join(",")+c+n+"}"}return is(a,"String")&&(t=a,a=null),i(e,"","")}),Object.defineProperty(global,"Ti",{value:Ti,writable:!1}),Object.defineProperty(global,"Titanium",{value:Ti,writable:!1}),API.info("Appcelerator Titanium "+ver+" Mobile Web"),cfg.vendorPrefixes||(cfg.vendorPrefixes=["","Moz","Webkit","O","ms"]),Ti.parse=JSON.parse,Ti.stringify=JSON.stringify,on(global,"beforeunload",shutdown),on(global,"unload",shutdown),has("ti-show-errors")&&on(global,"error",function(e){function a(e,a,t,i){_.add(UI.createLabel({color:t,font:{fontSize:i,fontWeight:"bold"},height:a,left:10,right:10,textAlign:UI.TEXT_ALIGNMENT_CENTER,text:e}))}if(!showingError){showingError=1;var t,i,n=e.filename||"",s=n.match(/:\/\/.+(\/.*)/),o=s?s[1]:e.filename,r=e.lineno,_=UI.createWindow({backgroundColor:"#f00",top:"100%",height:"100%",layout:UI._LAYOUT_CONSTRAINING_VERTICAL});a("Application Error","15%","#0f0","24pt"),a((e.message||"Unknown error").trim()+(o&&"undefined"!==o?" at "+o:"")+(r?" (line "+r+")":""),"45%","#fff","16pt"),_.add(t=UI.createView({height:"12%"})),t.add(i=UI.createButton({title:"Dismiss"})),_.addEventListener("close",function(){_.destroy()}),i.addEventListener("singletap",function(){_.animate({duration:500,top:"100%"},function(){_.close(),showingError=0})}),a("Error messages will only be displayed during development. When your app is packaged for final distribution, no error screen will appear. Test your code!","28%","#000","10pt"),on.once(_,"postlayout",function(){setTimeout(function(){_.animate({duration:500,top:0},function(){_.top=0,_.height="100%"})},100)}),_.open()}}),ready(function(){style.set(document.body,{margin:0,padding:0}),App.analytics&&(null===localStorage.getItem("ti:enrolled")&&(analytics.add("ti.enroll","ti.enroll",{app_name:App.name,oscpu:1,mac_addr:null,deploytype:deployType,ostype:Platform.osname,osarch:null,app_id:App.id,platform:Platform.name,model:Platform.model}),localStorage.setItem("ti:enrolled",!0)),analytics.add("ti.start","ti.start",{tz:(new Date).getTimezoneOffset(),deploytype:deployType,os:Platform.osname,osver:Platform.ostype,version:cfg.ti.version,platform:Platform.name,model:Platform.model,un:null,app_version:App.version,nettype:null}),analytics.send()),setTimeout(loadAppjs,1)}),Ti});